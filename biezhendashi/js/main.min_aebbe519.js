var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(t){try{h(i.next(t))}catch(e){s(e)}}function o(t){try{h(i["throw"](t))}catch(e){s(e)}}function h(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,o)}h((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(a=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(s,n[1])).done)return a;switch(s=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,s=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){h.label=n[1];break}if(6===n[0]&&h.label<a[1]){h.label=a[1],a=n;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(n);break}a[2]&&h.ops.pop(),h.trys.pop();continue}n=e.call(t,h)}catch(i){n=[6,i],s=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,s,a,o,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},ImageAtlasAnimate=function(t){function e(e,n,i,r){var s=t.call(this)||this;s.current=1,s.texturePointer=[],s.type=e,s.start=n,s.atlasName="mc"+s.type,s.length=i,s.frameRate=r,s.frameRate||(s.frameRate=24),s.frameRate>60&&(s.frameRate=60,console.log("？？？超过60帧大兄弟你不要玩我"));for(var a=0;i>=a;a++)s.texturePointer.push(RES.getRes(s.atlasName+"_"+(a+n)+"_jpg"));return s}return __extends(e,t),e.prototype.createLabel=function(t,e,n){},e.prototype.playFrom=function(t,e,n){t||(t=1),e||(e=this.length),n||(n=1),-1==n&&(n=1e6),this.playStart=t,this.playEnd=e,this.playTimes=n,this.current=this.playStart,this.interval=setInterval(function(){return 0==this.playTimes?(this.texture=this.texturePointer[this.length-1],clearInterval(this.interval),EvtMng.ins().notifyEvent(GameEvent.MCPLAYOVER,this.type),!1):(this.texture=this.texturePointer[this.current-1],this.current++,void(this.current>this.playEnd&&(this.playTimes--,this.current=this.playStart)))}.bind(this),1e3/this.frameRate)},e.prototype.play=function(t){this.texture=this.texturePointer[0],this.playFrom(0,0,t)},e.prototype.addPreloadPoint=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(this.atlasName+"_"+t),e},e}(egret.Bitmap);__reflect(ImageAtlasAnimate.prototype,"ImageAtlasAnimate");var Button=function(t){function e(e,n,i){var r=t.call(this)||this;return r.touchChildren=!1,r.touchEnabled=!0,r.width=n,r.height=i,r.graphics.lineStyle(5,2960685),r.graphics.beginFill(12632256,1),r.graphics.drawRoundRect(0,0,n,i,30,30),r.graphics.endFill(),r._lable=new egret.TextField,r._lable.text=e,r._lable.fontFamily="黑体",r._lable.textColor=2960685,r._lable.size=40,r._lable.bold=!0,r.addChild(r._lable),r._lable.x=(r.width-r._lable.width)/2,r._lable.y=(r.height-r._lable.height)/2,r}return __extends(e,t),e}(egret.Sprite);__reflect(Button.prototype,"Button");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeStage,e),e}return __extends(e,t),e.prototype.createView=function(){this.bg=new egret.Bitmap,this.addChild(this.bg),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=900,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.size=40,this.textField.textColor=16777215,this.textField.x=(egret.MainContext.instance.stage.stageWidth-this.textField.width)/2;var t=new egret.ImageLoader;t.once(egret.Event.COMPLETE,this.imgLoadHandler,this),t.load("resource/assets/loadBg.png")},e.prototype.imgLoadHandler=function(t){var e=t.currentTarget,n=e.data,i=new egret.Texture;i.bitmapData=n,this.bg.texture=i},e.prototype.onProgress=function(t,e){var n=Math.floor(t/e*100);this.textField.text="拼命加载中"+n+"%"},e.prototype.removeStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.bg=null,this.textField=null,document.body.style.background="#cecece"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.isPlay=!1,e._touchStatus=!1,e._distance=new egret.Point,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),t=new LoadingUI,[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),this.stage.addChild(t),[4,RES.loadGroup("preload",0,t)];case 2:return n.sent(),this.stage.removeChild(t),[3,4];case 3:return e=n.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){this.shape=new egret.Shape,this.shape.graphics.beginFill(13553358,1),this.shape.graphics.drawRect(0,0,this.width,this.height),this.shape.graphics.endFill(),this.addChild(this.shape),this.bg=this.createBitmap("bg_1_jpg"),this.addChild(this.bg),this.mc1=new ImageAtlasAnimate(1,Config.mcFrame[0][0],Config.mcFrame[0][1],20),this.mc2=new ImageAtlasAnimate(2,Config.mcFrame[1][0],Config.mcFrame[1][1],26),this.mc3=new ImageAtlasAnimate(3,Config.mcFrame[2][0],Config.mcFrame[2][1],20),this.shouzhi=this.createBitmap("shouzhi_png"),this.button=new Button("下载游戏",300,90),this.button.anchorOffsetX=this.button.width/2,this.button.anchorOffsetY=this.button.height/2,this.button.x=this.width/2,this.button.y=950,this.newBtn=new Button("再来一次",300,90),this.newBtn.anchorOffsetX=this.newBtn.width/2,this.newBtn.anchorOffsetY=this.newBtn.height/2,this.newBtn.x=this.width/2,this.newBtn.y=1100,this.newBtn2=new Button("再来一次",350,110),this.newBtn2.anchorOffsetX=this.newBtn2.width/2,this.newBtn2.anchorOffsetY=this.newBtn2.height/2,this.newBtn2.x=this.width/2,this.newBtn2.y=1050,this.newBtn2._lable.size=50,this.newBtn2._lable.x=(this.newBtn2.width-this.newBtn2._lable.width)/2,this.newBtn2._lable.y=(this.newBtn2.height-this.newBtn2._lable.height)/2,this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mouseUp,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.mouseUp,this),EvtMng.ins().registerEvent(GameEvent.MCPLAYOVER,this.palyOver,this),this.button.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),this.newBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),this.newBtn2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this)},e.prototype.mouseDown=function(t){1!=this._touchStatus&&(this._touchStatus=!0,this._distance.x=t.stageX,this._distance.y=t.stageY,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this))},e.prototype.mouseMove=function(t){if(1==this._touchStatus){var e=t.stageX-this._distance.x>40;if(0==e||1==this.isPlay)return;t.stageY>350&&t.stageY<420?0==this.index&&(this.index=1,this.isPlay=!0,this.addChild(this.mc1),this.mc1.play(1)):t.stageY>500&&t.stageY<570&&(this.isPlay=!0,0==this.index?(this.index=2,this.addChild(this.mc2),this.mc2.play(1)):1==this.index&&(this.index=3,this.addChild(this.mc3),this.mc3.play(1)))}},e.prototype.mouseUp=function(t){this._touchStatus=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.palyOver=function(t){if(this.isPlay=!1,t&&t.data){var e=t.data[0];1==e||(2==e?(this.removeDisplayObject(this.mc1),this.addChild(this.newBtn2)):3==e&&(this.removeDisplayObject(this.mc1),this.addChild(this.button),this.addChild(this.newBtn)))}},e.prototype.newGame=function(){console.log("新游戏"),this.isPlay=!1,this.index=0,this._touchStatus=!1,this.removeDisplayObject(this.mc1),this.removeDisplayObject(this.mc2),this.removeDisplayObject(this.mc3),this.removeDisplayObject(this.button),this.removeDisplayObject(this.newBtn),this.removeDisplayObject(this.newBtn2)},e.prototype.onClick=function(t){var e=this;egret.Tween.removeTweens(t.target),t.target.scaleX=t.target.scaleY=1,egret.Tween.get(t.target).to({scaleX:.85,scaleY:.85},120).to({scaleX:1,scaleY:1},120).call(function(t){egret.Tween.removeTweens(t),t==e.button?console.log("下载游戏"):t==e.newBtn?e.newGame():t==e.newBtn2&&e.newGame()},this,[t.target])},e.prototype.setGuide=function(t){void 0===t&&(t=0),egret.Tween.removeTweens(this.shouzhi);var e=egret.Tween.get(this.shouzhi,{loop:!0});0==t&&(this.shouzhi.x=250,this.shouzhi.y=385,e.to({x:450},1600).to({alpha:0},300).to({alpha:1},300).to({alpha:0},300).to({alpha:1},300).to({alpha:0},300).to({alpha:1},300).to({alpha:0},300).to({x:250},0).to({alpha:1},300))},e.prototype.createBitmap=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e.prototype.removeDisplayObject=function(t){t&&null!=t.parent&&t.parent.removeChild(t)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Config=function(){function t(){}return t.mcFrame=[[2,41],[13,78],[0,86]],t}();__reflect(Config.prototype,"Config");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var EvtMng=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.registerEvent=function(t,e,n){this.addEventListener(t,e,n)},e.prototype.notifyEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.dispatchEventWith(t,!1,e)},e.prototype.removeEvent=function(t,e,n){this.removeEventListener(t,e,n)},e}(egret.EventDispatcher);__reflect(EvtMng.prototype,"EvtMng");var GameEvent=function(){function t(){}return t.MCPLAYOVER="MCPLAYOVER",t.MCPLAYOVER1="MCPLAYOVER1",t.MCPLAYOVER2="MCPLAYOVER2",t.MCPLAYOVER3="MCPLAYOVER3",t}();__reflect(GameEvent.prototype,"GameEvent");